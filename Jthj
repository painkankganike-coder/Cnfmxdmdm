
-- Player Variables
local HideNameEnabled = false
local SpeedEnabled = false
local JumpEnabled = false
local AntiLookEnabled = false
local PickupEnabled = false
local InfiniteJumpEnabled = false
local speedMultiplier = 0.10
local AntiRagdollEnabled = false
local PickupEnabled = false
getgenv().InfiniteStaminaEnabled = false
local SnapHeightOffset = -7
local SnapDirection = "Down"
local SnapDuration = 0.1

-- ========================
-- Hide Name
-- ========================
local function RemoveBillboardGui()
    local char = LocalPlayer.Character
    if char then
        for _, gui in pairs(char:GetDescendants()) do
            if gui:IsA("BillboardGui") then gui:Destroy() end
        end
    end
end

CheaterTab:Toggle({
    Title = "Hide Name",
    Icon = "circle-check",
    Value = HideNameEnabled,
    Callback = function(state)
        HideNameEnabled = state
        if state then RemoveBillboardGui() end
    end
})

LocalPlayer.Character.ChildAdded:Connect(function(child)
    if HideNameEnabled and child:IsA("BillboardGui") then child:Destroy() end
end)

workspace.ChildAdded:Connect(function(child)
    if HideNameEnabled and child:IsA("Model") and child.Name == LocalPlayer.Name then
        child.ChildAdded:Connect(function(c)
            if HideNameEnabled and c:IsA("BillboardGui") then c:Destroy() end
        end)
    end
end)

-- ========================
-- Speed
-- ========================
CheaterTab:Toggle({
    Title = "Speed",
    Icon = "circle-check",
    Value = SpeedEnabled,
    Callback = function(state)
        SpeedEnabled = state
    end
})

RunService.RenderStepped:Connect(function(delta)
    if SpeedEnabled and LocalPlayer.Character then
        local char = LocalPlayer.Character
        local hum = char:FindFirstChildOfClass("Humanoid")
        local root = char:FindFirstChild("HumanoidRootPart")
        if hum and root then
            local moveDir = hum.MoveDirection
            if moveDir.Magnitude > 0 then
                root.CFrame = root.CFrame + moveDir.Unit * speedMultiplier * delta * 60
            end
        end
    end
end)

-- ========================
-- Jump
-- ========================
local function ApplyJump()
    local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.JumpPower = 20
        hum.JumpHeight = 20
    end
end
local function RemoveJump()
    local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.JumpPower = 50
        hum.JumpHeight = 7.2
    end
end

CheaterTab:Toggle({
    Title = "Jump",
    Icon = "circle-check",
    Value = JumpEnabled,
    Callback = function(state)
        JumpEnabled = state
        if state then ApplyJump() else RemoveJump() end
    end
})

-- ========================
-- Anti Lock / Anti Look
-- ========================
local ANIM_ID = "rbxassetid://104767795538635"
local currentAnimTrack

local function PlayAntiLook()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoid = char:WaitForChild("Humanoid")
    local anim = Instance.new("Animation")
    anim.AnimationId = ANIM_ID
    currentAnimTrack = humanoid:LoadAnimation(anim)
    currentAnimTrack.Looped = true
    currentAnimTrack:Play()
end

local function StopAntiLook()
    if currentAnimTrack then
        currentAnimTrack:Stop()
        currentAnimTrack = nil
    end
end

CheaterTab:Toggle({
    Title = "Anti Lock",
    Icon = "circle-check",
    Value = AntiLookEnabled,
    Callback = function(state)
        AntiLookEnabled = state
        if state then PlayAntiLook() else StopAntiLook() end
    end
})

-- ========================
-- Infinite Jump
-- ========================
CheaterTab:Toggle({
    Title = "Infinite Jump",
    Icon = "circle-check",
    Value = InfiniteJumpEnabled,
    Callback = function(state)
        InfiniteJumpEnabled = state
    end
})

local UndergroundEnabled = false
local UndergroundAutoEnabled = true
local AntiRagdollEnabled = false

local UndergroundDepth = 50
local SpinSpeed = 2080
local UndergroundRadius = 6
local UndergroundAngle = 0

local function StartUnderground()
    local char = player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    UndergroundEnabled = true
    local initialY = hrp.Position.Y - UndergroundDepth

    local conn
    conn = RunService.RenderStepped:Connect(function(delta)
        if not UndergroundEnabled or not hrp.Parent then
            conn:Disconnect()
            return
        end

        UndergroundAngle = (UndergroundAngle + SpinSpeed * delta) % 360
        local rad = math.rad(UndergroundAngle)

        local offsetX = math.cos(rad) * UndergroundRadius
        local offsetZ = math.sin(rad) * UndergroundRadius
        local newPos = Vector3.new(hrp.Position.X + offsetX, initialY, hrp.Position.Z + offsetZ)

        hrp.CFrame = CFrame.new(newPos, Vector3.new(hrp.Position.X, initialY, hrp.Position.Z))
    end)
end

local function StopUnderground()
    UndergroundEnabled = false
end

local function AntiRagdoll()
    local char = player.Character
    if not char then return end
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not humanoid or not hrp then return end
    if humanoid.PlatformStand then
        humanoid.PlatformStand = false
        humanoid.Sit = false
        hrp.Velocity = Vector3.new(0,0,0)
        hrp.RotVelocity = Vector3.new(0,0,0)
    end
end

-- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å‡πÄ‡∏ü‡∏£‡∏°
RunService.RenderStepped:Connect(function()
    local char = player.Character
    if not char then return end
    local humanoid = char:FindFirstChild("Humanoid")
    if not humanoid then return end

    -- Underground Auto
    if UndergroundAutoEnabled then
        if humanoid.Health <= 15 and humanoid.Health > 0 then
            if not UndergroundEnabled then StartUnderground() end
        elseif humanoid.Health >= 30 or humanoid.Health == 0 then
            if UndergroundEnabled then StopUnderground() end
        end
    end

    -- Anti Ragdoll
    if AntiRagdollEnabled then
        AntiRagdoll()
    end
end)

-- Toggle ‡∏õ‡∏∏‡πà‡∏°
CheaterTab:Toggle({
    Title = "Anti Kill",
    Icon = "circle-check",
    Value = UndergroundAutoEnabled,
    Callback = function(state)
        UndergroundAutoEnabled = state
        if not state then UndergroundEnabled = false end
    end
})

UserInputService.JumpRequest:Connect(function()
    if InfiniteJumpEnabled then
        local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
    end
end)

-- Anti Ragdoll (WindUI Toggle Version)
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

local CounterTable

-- ‡∏´‡∏≤ CounterTable
local function findCounter()
    for _, obj in ipairs(getgc(true)) do
        if typeof(obj) == "table" and rawget(obj, "event") and rawget(obj, "func") then
            return obj
        end
    end
    return nil
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° Anti Ragdoll
local function startAntiRagdoll()
    CounterTable = findCounter()
    if not CounterTable then
        warn("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö CounterTable!")
        return
    end

    spawn(function()
        while AntiRagdollEnabled do
            CounterTable.event = (CounterTable.event or 0) + 1
            local SendRemote = ReplicatedStorage.Remotes:WaitForChild("Send")
            pcall(function()
                SendRemote:FireServer(CounterTable.event, "end_ragdoll_early")
            end)
            wait(0.3)

            if AntiRagdollEnabled then
                CounterTable.event = (CounterTable.event or 0) + 1
                pcall(function()
                    SendRemote:FireServer(CounterTable.event, "clear_ragdoll")
                end)
            end
            wait(0.3)
        end
    end)
end

-- WindUI Toggle
CheaterTab:Toggle({
    Title = "Anti Ragdoll",
    Icon = "shield-check", -- ‡πÉ‡∏™‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    Value = AntiRagdollEnabled,
    Callback = function(state)
        AntiRagdollEnabled = state
        if AntiRagdollEnabled then
            startAntiRagdoll()
            print("‚úÖ Anti Ragdoll ON")
        else
            print("‚ùå Anti Ragdoll OFF")
        end
    end
})

-- Auto start ‡πÄ‡∏°‡∏∑‡πà‡∏≠ respawn
player.CharacterAdded:Connect(function()
    if AntiRagdollEnabled then
        wait(1)
        startAntiRagdoll()
    end
end)

-- ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local rootPart = char:WaitForChild("HumanoidRootPart")


-- ‡∏´‡∏≤ CounterTable
local CounterTable
pcall(function()
    for _, Obj in ipairs(getgc(true)) do
        if typeof(Obj) == "table" and rawget(Obj, "event") and rawget(Obj, "func") then
            CounterTable = Obj
            break
        end
    end
end)

-- NetGet Function
local function NetGet(...)
    if not CounterTable or not CounterTable.func then return end
    local args = {...}
    CounterTable.func = (CounterTable.func or 0) + 1
    local success, result = pcall(function()
        local GetRemote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("Get")
        return GetRemote:InvokeServer(CounterTable.func, unpack(args))
    end)
    if not success then warn("[NetGet Error]", result) end
    return result
end

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏≠‡πÄ‡∏ó‡πá‡∏°
local function CheckAndPickup()
    if not PickupEnabled then return end
    local droppedFolder = workspace:FindFirstChild("DroppedItems") or workspace:FindFirstChild("DroppedItem")
    if not droppedFolder then return end

    for _, item in ipairs(droppedFolder:GetChildren()) do
        if item.Name == "Money" then continue end
        if item:IsA("Model") and item:FindFirstChildWhichIsA("BasePart") then
            local modelCF = item.GetPivot and item:GetPivot() or item:GetModelCFrame()
            local distance = (rootPart.Position - modelCF.Position).Magnitude
            if distance <= 15 then
                pcall(function()
                    NetGet("pickup_dropped_item", item)
                end)
            end
        end
    end
end

-- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï char ‡πÉ‡∏´‡∏°‡πà
player.CharacterAdded:Connect(function(newChar)
    char = newChar
    rootPart = char:WaitForChild("HumanoidRootPart")
end)

-- Loop ‡∏ó‡∏∏‡∏Å‡πÄ‡∏ü‡∏£‡∏°
RunService.Heartbeat:Connect(CheckAndPickup)

CheaterTab:Toggle({
    Title = "Pickup Items",
    Icon = "circle-check",
    Value = PickupEnabled,
    Callback = function(state)
        PickupEnabled = state
        print("üß≤ Auto Pickup Items:", state and "ON" or "OFF")
    end
})

-- Assuming you‡∏°‡∏µ WindUI ‡πÅ‡∏•‡∏∞ Tab ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ CheaterTab ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

local AutoSprintLoop
local OriginalSprintUpdate
local Send

-- Setup Remotes
pcall(function()
    local Remotes = ReplicatedStorage:WaitForChild("Remotes", 10)
    if Remotes then
        Send = Remotes:WaitForChild("Send", 5)
    end
end)

local function NetSend(action, state)
    if Send then
        pcall(function()
            Send:FireServer(action, state)
        end)
    end
end

local function EnableInfiniteStamina()
    local success, SprintModule = pcall(function()
        return require(ReplicatedStorage.Modules.Game.Sprint)
    end)
    if not success or not SprintModule then
        warn("‚ùå SprintModule ‡πÑ‡∏°‡πà‡∏û‡∏ö!")
        return false
    end

    local consume_stamina = SprintModule.consume_stamina
    local sprintData = getupvalue(consume_stamina, 2)
    if not sprintData or not sprintData.sprint_bar then
        warn("‚ùå SprintBar ‡πÑ‡∏°‡πà‡∏û‡∏ö!")
        return false
    end

    local SprintBar = sprintData.sprint_bar
    OriginalSprintUpdate = SprintBar.update

    SprintBar.update = function(...)
        return OriginalSprintUpdate(function()
            return 1 -- Stamina ‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏™‡∏°‡∏≠
        end)
    end

    AutoSprintLoop = task.spawn(function()
        while getgenv().InfiniteStaminaEnabled do
            pcall(function()
                NetSend("set_sprinting_1", true)
                task.wait(0.5)
                NetSend("set_sprinting_1", false)
            end)
            task.wait(0.1)
        end
        NetSend("set_sprinting_1", false)
    end)

    print("‚úÖ Infinite Stamina ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß! üèÉ‚Äç‚ôÇÔ∏èüí®")
    return true
end

local function DisableInfiniteStamina()
    getgenv().InfiniteStaminaEnabled = false

    if AutoSprintLoop then
        task.cancel(AutoSprintLoop)
        AutoSprintLoop = nil
    end

    NetSend("set_sprinting_1", false)

    -- Restore Original
    local success, SprintModule = pcall(function()
        return require(ReplicatedStorage.Modules.Game.Sprint)
    end)
    if success and SprintModule then
        local consume_stamina = SprintModule.consume_stamina
        local sprintData = getupvalue(consume_stamina, 2)
        if sprintData and sprintData.sprint_bar and OriginalSprintUpdate then
            sprintData.sprint_bar.update = OriginalSprintUpdate
            OriginalSprintUpdate = nil
        end
    end

    print("‚ùå Infinite Stamina ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß!")
end

-- ======= WindUI Toggle =======
CheaterTab:Toggle({
    Title = "Infinite Stamina",
    Icon = "circle-check", -- ‡πÉ‡∏™‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    Value = getgenv().InfiniteStaminaEnabled,
    Callback = function(state)
        getgenv().InfiniteStaminaEnabled = state
        if state then
            EnableInfiniteStamina()
        else
            DisableInfiniteStamina()
        end
    end
})


-- ========================
-- Snap / Dig
-- ========================
CheaterTab:Section({Title="Snap PC key [ Z ]"})
local isRunning = false
local function SnapQuick()
    if isRunning then return end
    isRunning = true
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = char:FindFirstChild("HumanoidRootPart")
    local hum = char:FindFirstChildOfClass("Humanoid")
    if not hrp or not hum then isRunning=false return end
    hum.Sit = true
    local origY = hrp.Position.Y
    local offset = math.abs(SnapHeightOffset)
    if SnapDirection == "Down" then offset = -offset end
    local conn
    conn = RunService.RenderStepped:Connect(function()
        if hrp and hrp.Parent then
            hrp.CFrame = hrp.CFrame:Lerp(CFrame.new(hrp.Position.X, origY+offset, hrp.Position.Z),0.8)
        end
    end)
    task.wait(SnapDuration)
    if conn then conn:Disconnect() conn=nil end
    hum.Sit=false
    isRunning=false
end

CheaterTab:Button({
    Title="Snap Click",
    Locked=false,
    Callback=function() SnapQuick() end
})

CheaterTab:Slider({
    Title="Snap Depth",
    Step=1,
    Value={Min=1,Max=50,Default=math.abs(SnapHeightOffset)},
    Callback=function(val)
        SnapHeightOffset=(SnapDirection=="Down" and -1 or 1)*val
    end
})

CheaterTab:Dropdown({
    Title="Snap Direction",
    Values={"Down","Up"},
    Value=SnapDirection,
    Callback=function(opt)
        SnapDirection=opt
        SnapHeightOffset=(opt=="Down" and -1 or 1)*math.abs(SnapHeightOffset)
    end
})

UserInputService.InputBegan:Connect(function(input,gpe)
    if gpe then return end
    if input.KeyCode==Enum.KeyCode.Z then SnapQuick() end
end)
